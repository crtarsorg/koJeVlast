<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Ko je vlast</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
	
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.4.0/d3.min.js"></script>

    <script src="viz/donut.js"></script>
    <!-- 
    <script src=""></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.12/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables-tabletools/2.1.5/js/TableTools.min.js"></script> -->
    <style type="text/css">
    #mapa{
    	text-align: center;
    }
    </style>
</head>

<body>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Title</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Link</a></li>
                    <li><a href="#">Link</a></li>
                </ul>
                <form class="navbar-form navbar-left" role="search">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search">
                    </div>
                    <button type="submit" class="btn btn-default">Submit</button>
                </form>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#">Link</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Action</a></li>
                            <li><a href="#">Another action</a></li>
                            <li><a href="#">Something else here</a></li>
                            <li><a href="#">Separated link</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </nav>
    <div class="container-fluid" id="mainWrapper">
        <div id="mapa" class="col-lg-6"></div>
        <div id="indikator" class="col-lg-6"> </div>
       
        <script>
        $("#indikator").load("forma.html")

        $.get("modal.html", function(data) {
            $("#mainWrapper").append(data);
        });
        </script>
    </div>
    <script type="text/javascript">
    var podaci = [];

    $.getJSON('data/poOpstini.json', function(json, textStatus) {
        podaci = json;
    });

    $("#mapa").load("srbija.svg", function() {

        //$("#mapa").trigger("ucitano", ["Custom", "Event"]);
        var selektor = "#mapa path:not(#KiM path),#mapa polygon:not(#KiM polygon)";

        mouseEvents(selektor);

        /*  $("#juzna_i_istocna_srbija_1>g").hide()
          $("#zapadna_backa_2>g").hide()
          */
    });

    function mouseEvents(selektor) {

        $(selektor)
            .on("mouseover.boja", function() {
                $(this).css("fill", "orange");
            });

        $(selektor)
            .on("mouseleave.boja", function() {
                $(this).css("fill", "rgb(155, 227, 220)");
            });


        $(selektor).click(function() {
            var temp = $(this).parent()[0].id

            //uzmi podatke po opsitni
            //potrebi su dobri identifikatori na mapi; 
            //ali i u podacima

            var tempData = Object.keys(podaci);
            random_index = parseInt(Math.random() * tempData.length);

            random_index = tempData[random_index];

            console.log(random_index);
            console.log(tempData.length);

            temp = podaci[random_index];
            popuni_modal(temp);

            drawSvg();

            $('#modal_id').modal('show')

        });

    }

    function popuni_modal(pod_opstina) {

        //$var_novo = $(".single-row").clone();
        $("tbody").empty();

        for (var i = 0; i < pod_opstina.length; i++) {
            var temp = pod_opstina[i];

            //setuj promenljive
            var jedan_red =
                '<tr class="single-row">' +
	                '<td class="row-ime">' + temp.ime_prezime + '</td>' +
	                '<td class="row-stranka">' + temp.stranka + '</td>' +
	                '<td class="row-funkcija">' + temp.funkcija + '</td>' +
	                '<td class="row-koalicija">' + temp.koalicija + '</td>' +
	                '<td class="row-vlast">' + temp.u_vlasti + '</td>' +
                '</tr>';
            $("tbody").append(jedan_red);


        }


    }
    </script>
</body>

</html>
